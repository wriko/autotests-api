Хранение фикстур в conftest.py
Ссылки:

Официальная документация Pytest по работе с conftest.py файлами
Фикстуры можно объявлять в трех местах:

В самих тестовы файлах, например в файле test_users.py можно объявить фикстуру
В специальных файлах conftest.py, об этом поговорим в данном шаге
В плагинах — один из самых верных и мощных способов хранения фикстур, о нем поговорим позже
Файл conftest.py в pytest — это место, где можно хранить фикстуры, которые будут доступны во всем проекте или в отдельных модулях без необходимости их явного импорта. Это облегчает структуру тестов и позволяет разделять фикстуры по разным уровням.

Особенности conftest.py:
Глобальная доступность: фикстуры, определенные в conftest.py, автоматически доступны в тестах, расположенных в том же каталоге или подкаталогах.
Нет импорта: pytest автоматически обнаруживает и использует фикстуры из conftest.py, их не нужно импортировать в тестовые файлы.
Упрощение структуры проекта: фикстуры, которые часто используются в проекте, можно поместить в conftest.py для повторного использования во всех тестах.
Пример conftest.py

@pytest.fixture
def users_client():
    client = new_users_client()
    yield client
    client.close()
Использование фикстур из conftest.py в тестах:

# tests/test_example.py
def test_create_user(users_client):
    users_client.create_user()
В этом примере фикстура users_client из файла conftest.py автоматически доступна в тестовом файле test_example.py без необходимости её импорта.

Преимущества использования conftest.py
Централизация фикстур: Фикстуры, которые могут использоваться в нескольких модулях, помещаются в одном месте.
Чистота тестов: Тесты остаются проще и чище, так как фикстуры доступны глобально.
Повторное использование: Фикстуры можно использовать в любых тестах, расположенных в том же каталоге или ниже по иерархии файлов.


Организация conftest.py для разных уровней
pytest позволяет создавать несколько файлов conftest.py в разных каталогах. Фикстуры в них будут применяться только к тестам в том же каталоге и подкаталогах. Это удобно для разделения контекста и создания фикстур, специфичных для определенных частей проекта.

Пример организации файлов:

.
└── tests/
    ├── conftest.py # Фикстуры будут доступны во всех автотестах
    ├── registration/
    │   ├── conftest.py # Фикстуры будут доступны ТОЛЬКО в рамках модуля registration
    │   ├── test_registration.py
    │   └── test_admin_registration.py
    └── authorization/
        ├── conftest.py # Фикстуры будут доступны ТОЛЬКО в рамках модуля authorization
        ├── test_authorization.py
        └── test_admin_authorization.py
Глобальный conftest.py: фикстуры в tests/conftest.py будут доступны во всех тестах.
Локальные conftest.py: фикстуры в registration/conftest.py будут доступны только в registration.